#include <stdint.h>
#include <string.h>
#include <assert.h>
#include <stdio.h>
#include <inttypes.h>

#include "api.h"

#include "jade_hash.h"
#include "print.h"

int main(void)
{
  int r;
  uint8_t hash[JADE_HASH_BYTES];

  // 24 bits / 3 bytes of input message:
  // abc
  uint8_t input[] = {
    0x61, 0x62, 0x63
  };

  // 512 bits / 64 bytes / 1 block of input message:
  // abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd
  // uint8_t input[] = {
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64
  // };

  // 1024 bits / 128 bytes / 2 block of input message:
  // abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd
  // uint8_t input[] = {
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64
  // };

  // 58*U + two blocks of abc =
  // UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd
  // uint8_t input[] = {
  //   0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 
  //   0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 
  //   0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 
  //   0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
  //   0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 
  //   0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
  //   0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 
  //   0x55, 0x55,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64
  // };

  // 2048 bits / 256 bytes / 4 block of input message:
  // abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd
  // uint8_t input[] = {
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64,
  //   0x61, 0x62, 0x63, 0x64, 0x61, 0x62, 0x63, 0x64
  // };

  //
  r = jade_hash(hash, input, sizeof(input));
  // 0 bits of input message:
  // r = jade_hash(hash, input, 0);
    assert(r == 0);

  print_info(JADE_HASH_ALGNAME, JADE_HASH_ARCH, JADE_HASH_IMPL);
  print_str_u8("input", input, sizeof(input));
  print_str_u8("hash", hash, JADE_HASH_BYTES);

  return 0;
}

